/*! photoAlbum 2014-07-20 */
function PhotoAlbum(a){this._container=document.getElementById(a.containerId),this._photos=a.list,this._size=a.size||100,this.init(),this.renderDOM(),this.bindDOM()}PhotoAlbum.prototype.init=function(){this._winW=window.innerWidth,this._winH=window.innerHeight,this._breviary=document.createElement("div"),this._breviary.id="breviary",this._large=document.createElement("div"),this._large.id="large",this._large.style.display="none",this._large.setAttribute("class","animated fadeIn"),this._largeImg=document.createElement("img"),this._large.appendChild(this._largeImg),this._container.appendChild(this._large),this._breviaryUl=document.createElement("ul"),this._wholeCount=this._photos.length,this._marginBottom="5px"},PhotoAlbum.prototype.renderImgs_square=function(a,b,c){var d=a._size,e=0,f=a._marginBottom,g=Math.floor(a._winW/(d+e)),h=(a._winW-g*d)/g,i=0,j=0;b.width/b.height>1.2?(j=d,i=b.width/b.height*j):(i=d,j=b.height/b.width*i),b._cvs.drawImage(b,0,0,i,j),b._li.style.width=d+"px",b._li.style.height=d+"px",c%g!=1&&(b._li.style.paddingLeft=h+"px"),b._li.style.marginTop=f,b._li.setAttribute("class","square animated bounceIn"),a._breviaryUl.appendChild(b._li)},PhotoAlbum.prototype.renderDOM=function(){for(var a=this,b=0,c=0;c<a._wholeCount;c++){var d=new Image;d.onload=function(){var c=document.createElement("canvas");c.id=b,c.setAttribute("data-src",this.src),c.setAttribute("data-width",this.width),c.setAttribute("data-height",this.height),c.width=a._size,c.height=a._size,this._li=document.createElement("li"),this._li.appendChild(c),this._cvs=c.getContext("2d"),b+=1,a.renderImgs_square(a,this,b)},d.src=this._photos[c].src}a._breviary.appendChild(a._breviaryUl),a._container.appendChild(a._breviary)},PhotoAlbum.prototype.loadImg=function(a,b,c,d){var e=document.getElementById(b),f=e.getAttribute("data-height")/e.getAttribute("data-width"),g=a._winH/a._winW,h=e.getAttribute("data-src"),i=new Image,j=0,k=0,l=0,m=0;i.onload=function(){switch(c){case"swipeLeft":a._largeImg.setAttribute("class","animated bounceInRight");break;case"swipeRight":a._largeImg.setAttribute("class","animated bounceInLeft")}a._largeImg.src=h,g>=f?(m=a._winW,l=f*m,j=parseInt((a._winH-l)/2),styles={width:m,height:l,paddingTop:j+"px",paddingLeft:0}):f>g&&(l=a._winH,m=l/f,k=parseInt((a._winW-m)/2),styles={width:m,height:l,paddingTop:0,paddingLeft:k+"px"}),$(a._largeImg).css(styles),d&&d()},i.src=h},PhotoAlbum.prototype.bindDOM=function(){var a=this,b=0;$(this._breviary).on("tap","canvas",function(){b=this.id,a._large.style.display="block",a.loadImg(a,b)}),$(this._large).on("tap",function(){a._large.style.display="none"}).on("swipeRight",function(){var c=b-1,d=a._largeImg;c>=0&&a.loadImg(a,c,"swipeRight",function(){d.addEventListener("webkitAnimationEnd",function(){d.removeAttribute("class"),d.removeEventListener("webkitAnimationEnd")},!1),b=c})}).on("swipeLeft",function(){var c=parseInt(b)+1,d=a._largeImg;c<a._wholeCount&&a.loadImg(a,c,"swipeLeft",function(){d.addEventListener("webkitAnimationEnd",function(){d.removeAttribute("class"),d.removeEventListener("webkitAnimationEnd")},!1),b=c})})};